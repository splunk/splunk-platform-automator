---
# Main playbook for this role

- name: Start role tasks
  tags:
    - splunk
    - universal_forwarder
  ansible.builtin.debug:
    msg: "role '{{ role_name }}' start"

- name: Apply baseconfig app org_all_deploymentclient
  tags:
    - splunk
    - splunk_baseconfig
    - universal_forwarder
    - org_all_deploymentclient
  ansible.builtin.include_role:
    name: baseconfig_app
  vars:
    app_name: 'org_all_deploymentclient'
    app_path: '{{splunk_home}}/etc/apps'
  when: splunk_deployment_server|default()|length > 0 and inventory_hostname not in groups.role_deployment_server

- name: Apply baseconfig app org_all_forwarder_outputs
  tags:
    - splunk
    - splunk_baseconfig
    - universal_forwarder
    - org_all_forwarder_outputs
  ansible.builtin.include_role:
    name: baseconfig_app
  vars:
    app_name: 'org_all_forwarder_outputs'
    app_path: '{{splunk_home}}/etc/apps'
  when: splunk_deployment_server|default()|length == 0
