---
# This playbook configures host and servername settings

- name: Set serverName to {{inventory_hostname}}
  tags:
    - splunk
    - splunk_software
    - splunk_set_servername
  community.general.ini_file:
    path: "{{ splunk_home }}/etc/system/local/server.conf"
    section: general
    option: "serverName"
    value: "{{inventory_hostname}}"
    owner: "{{splunk_user}}"
    group: "{{splunk_group}}"
    mode: 0600
  notify: Restart splunk
  when: splunk_set_servername|default(false) == true

- name: Set default-hostname to {{inventory_hostname}}
  tags:
    - splunk
    - splunk_software
    - splunk_set_default_hostname
  community.general.ini_file:
    path: "{{ splunk_home }}/etc/system/local/inputs.conf"
    section: default
    option: "host"
    value: "{{inventory_hostname}}"
    owner: "{{splunk_user}}"
    group: "{{splunk_group}}"
    mode: 0600
  notify: Restart splunk
  when: splunk_set_default_hostname|default(false) == true
